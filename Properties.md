# 属性系统设计文档

这是一个无状态的细胞自动机系统，所有行为由物理法则驱动，而非状态机。

## 核心设计原则：无状态物理系统

本系统**没有传统意义上的状态机**，所有行为完全基于物理计算。Cell 的"类型变化"只是物理属性达到阈值时的自然结果。

### 物理属性计算
- **温度变化** → 相变临界点 → 新物质类型
- **湿度变化** → 干燥/饱和临界点 → 新物质类型  
- **能量消耗** → 燃尽临界点 → 新物质类型

## 动态属性（运行时计算）

这些属性在每个游戏 tick 被物理系统实时计算：

| 属性 | 计算系统 | 物理意义 |
|---|---|---|
| `Temperature` | 热传导系统 | 基于 HeatConductivity 的热传递 |
| `Moisture` | 湿度扩散系统 | 水分蒸发/吸收平衡 |
| `Energy` | 燃烧系统 | 化学能释放速率 |
| `Velocity` | 物理系统 | 基于质量和力的运动 |

## 静态基准（CSV 配置）

CellConfigs.csv 中的数值是**物理常数**，不是状态定义：

### 物理常数
- `Mass_Default` - 基础质量（kg）
- `HeatConductivity` - 导热系数（0-1）
- `Fluidity` - 流体扩散系数
- `Viscosity` - 内摩擦系数

### 相变阈值
- `Temperature_Min/Max` - 相变温度边界
- `Moisture_Min/Max` - 湿度相变边界  
- `IgnitionPoint` - 自燃温度阈值
- `ExplosionPoint` - 爆炸温度阈值

### 资源掉落概率
- `DropChance_*` - 挖掘时的矿物掉落概率

## 21种物质物理特性表

| 物质 | 状态 | 质量 | 导热率 | 流体性 | 粘度 | 温度范围 | 特殊性质 |
|---|---|---|---|---|---|---|---|
| 岩浆 | Liquid | 15 | 0.8 | 0.9 | 0.3 | 800-99999°C | 高温热源 |
| 火山岩 | Solid | 28 | 0.75 | 0.1 | 0.9 | <800°C | 岩浆冷却产物 |
| 水 | Liquid | 10 | 0.6 | 0.9 | 0.1 | 0-100°C | 湿度调节器 |
| 冰 | Solid | 9 | 0.25 | 0.1 | 0.9 | <0°C | 低温稳定 |
| 雪 | Powder | 1 | 0.05 | 0.6 | 0.4 | <0°C | 可压实 |
| 木头 | Solid | 7 | 0.15 | 0.1 | 0.8 | 全温度 | 可燃 300°C |
| 湿木头 | Solid | 9 | 0.25 | 0.2 | 0.7 | <100°C | 阻燃 |
| 烧焦木头 | Solid | 6 | 0.1 | 0.1 | 0.8 | <800°C | 燃烧残留 |
| 沙子 | Powder | 16 | 0.35 | 0.6 | 0.2 | <1700°C | 高流体性 |
| 泥土 | Powder | 14 | 0.5 | 0.5 | 0.6 | 全温度 | 保水性好 |
| 花岗岩 | Solid | 27 | 0.85 | 0.05 | 0.95 | <1400°C | 高导热 |
| 玄武岩 | Solid | 30 | 0.2 | 0.05 | 0.95 | <1500°C | 高密度 |
| 基岩 | Solid | 9999 | 0 | 0 | 1 | 全温度 | 不可破坏 |

## 物理系统行为

### 热力学系统
- 热量总是从高温向低温传递
- 热传递速率 = HeatConductivity × 温差
- 温度达到阈值时触发相变

### 流体动力学
- 液体：密度分层，重物质下沉
- 粉末：重力沉积，可堆叠
- 流体性决定扩散范围：Solid=1, Powder=9, Liquid=17 个方向

### 燃烧系统
- 温度 ≥ IgnitionPoint 时开始燃烧
- 能量随时间线性减少：Energy -= burnRate × deltaTime
- Energy ≤ 0 时转化为燃烧产物

## 无状态转换示例

```
木头燃烧过程：
初始: Wood(T=20°C, Energy=1500J)
↓ 温度上升
点燃: T ≥ 300°C → 开始燃烧
↓ 能量减少
燃尽: Energy ≤ 0 → 转化为烧焦木头
↓ 冷却
最终: WoodScorched(T=100°C, Energy=750J)
```

整个过程中没有状态转换，只有物理属性的连续变化。